%!TEX encoding = UTF-8 Unicode
%!TEX root = ../lect-w09.tex


\Subsection{Serialisering och deserialisering}

\begin{Slide}{Serialisering och deserialisering}
\begin{itemize}
  \item Att \Emph{serialisera} innebär att \Alert{koda objekt} i minnet till en avkodningsbar \Alert{sekvens av symboler}, som kan lagras t.ex. i en fil på din hårddisk.
  \item Att \Emph{de-serialisera} innebär att \Alert{avkoda en sekvens av symboler}, t.ex. från en fil, och \Alert{återskapa objekt} i minnet.
\end{itemize}
\end{Slide}


\begin{Slide}{Läsa text från fil och webbsida}\SlideFontSmall
I paketet \code{scala.io} finns singelobjektet \code{Source} med metoderna:
\begin{itemize}\SlideFontTiny
  \item  \code{fromFile} för läsning från fil
  \item \code{fromUrl} för läsning från URL (Universal Resource Locator) \texttt{http://some.site.domain/page.html}

\end{itemize}
\begin{CodeSmall}
def läsFil(filnamn: String, kodning: String = "UTF-8"): String = 
  val s = scala.io.Source.fromFile(filnamn, kodning)
  try s.mkString finally s.close // säkerställ stängning även vid krasch

def läsRaderFrånFil(filnamn: String, kodning: String = "UTF-8"): Vector[String] =
  val s = scala.io.Source.fromFile(filnamn, kodning)
  try s.getLines.toVector finally s.close 

def läsWebbsida(url: String, kodning: String = "UTF-8"): String = 
  val s = scala.io.Source.fromURL(url, kodning)
  try s.mkString finally s.close

def läsRaderWebbsida(url: String, kodning: String = "UTF-8"): Vector[String] =
  val s = scala.io.Source.fromURL(url, kodning) // läs med given teckenkodning
  try s.getLines.toVector finally s.close 

\end{CodeSmall}
{\SlideFontTiny Se vidare veckans övning. Exempel på annan teckenkodning: \code{"ISO-8859-1"} }
\end{Slide}


\begin{Slide}{Serialisering i modulen \texttt{introprog.IO}}\SlideFontSmall
\begin{itemize}
\item I kursens kodbibliotek \code{introprog} finns ett singelobjekt \code{IO} som samlar smidiga funktioner för serialisering och de-serialisering. 
\item Se api-dokumentation här: \\ \url{https://fileadmin.cs.lth.se/pgk/api} \\ Sök på IO och klicka på singelobjektet.
\item Se koden här:\\
\url{https://github.com/lunduniversity/introprog-scalalib/blob/master/src/main/scala/introprog/IO.scala}
\item Om du vill får du gärna använda \code{introprog.IO} istället för \code{scala.io.Source} på labben.  
\end{itemize}
\end{Slide}
